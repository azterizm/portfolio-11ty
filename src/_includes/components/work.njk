<div id='work'>
  <div class="flex items-center justify-between z-10 sticky top-2 left-0">
    <h2 class="bg-white/10 backdrop-blur-lg text-8xl">work</h2>
    <div class="relative hidden sm:block">
      <img src="/assets/eye-bg.png" alt="eye icon" class='w-56' />
      <div id='eye-ball'
        class="transition-all duration-100 ease-in-out bg-pure-white w-12 h-16 rounded-[50%] absolute inset-6"></div>
    </div>
  </div>

  <!-- SEO-friendly initial projects - visible to search engines, hidden by JS after load -->
  <div id="projects-seo" class="grid grid-cols-8 mt-16 gap-x-8 gap-y-16">
    {% for project in collections.projects %}
    {% if not project.data.blocked_countries or 'ALL' not in project.data.blocked_countries %}
    <div class="col-span-8 lg:col-span-3 project-item flex flex-col">
      <div class="relative">
        <img src="{{ project.data.main_image }}" alt="{{project.data.title}}"
          class="w-full mb-4 rounded-xl main-image" />
        <div class="p-4 bg-white/30 backdrop-blur-lg rounded-lg absolute top-4 left-4 ">
          <img src="{{project.data.logo}}" alt="{{title}} logo" class="w-8 lg:w-16 project-logo" />
        </div>
      </div>
      <p class="project-title text-3xl">{{project.data.title}}</p>
      <p class="text-md">{{project.data.year}}</p>
    </div>
    <div class="col-span-8 lg:col-span-2 flex flex-col justify-between mt-4 lg:mt-0">
      <p>{{ project.data.description }}</p>
      <p class="mt-4 lg:mt-0">{{project.data.technologies | join(', ')}}</p>
    </div>
    <div class="col-span-8 lg:col-span-3 flex flex-col justify-end mt-4 lg:mt-0">
      <a href='{{project.page.url}}'
        class="p-4 w-full bg-white border-2 border-black flex items-center justify-center rounded-full cross-fade-link mx-auto lg:mx-0 max-w-xs">
        <svg xmlns="http://www.w3.org/2000/svg" width="56" height="56" fill="#000000" viewBox="0 0 256 256">
          <path
            d="M221.66,133.66l-72,72a8,8,0,0,1-11.32-11.32L196.69,136H40a8,8,0,0,1,0-16H196.69L138.34,61.66a8,8,0,0,1,11.32-11.32l72,72A8,8,0,0,1,221.66,133.66Z">
          </path>
        </svg>
      </a>
    </div>
    <div class="col-span-8 bg-black h-[1px]"></div>
    {% endif %}
    {% endfor %}
  </div>

  <!-- Loading state - hidden by default, shown by JS -->
  <div id="projects-loading" class="grid grid-cols-8 mt-16 gap-x-8 gap-y-16 hidden">
    <div class="col-span-8 text-center py-8">
      <p class="text-xl">Loading projects...</p>
    </div>
  </div>

  <!-- Dynamic projects container - populated by JS -->
  <div id="projects-container" class="grid grid-cols-8 mt-16 gap-x-8 gap-y-16 hidden">
  </div>

  <!-- Global projects data for JavaScript -->
  <script>
    window.projectsData = [
      {% for project in collections.projects %}
      {
        title: {{ project.data.title | dump | safe }},
        main_image: {{ project.data.main_image | dump | safe }},
        logo: {{ project.data.logo | dump | safe }},
        year: {{ project.data.year | dump | safe }},
        description: {{ project.data.description | dump | safe }},
        technologies: {{ project.data.technologies | dump | safe }},
        url: {{ project.page.url | dump | safe }},
        blocked_countries: {{ project.data.blocked_countries | default([]) | dump | safe }}
      }{% if not loop.last %},{% endif %}
      {% endfor %}
    ];
  </script>
</div>
